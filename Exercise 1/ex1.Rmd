---
title: "ASML EXAM Exercise 1"
output: html_notebook
header-includes:
   - \usepackage{bbm}
---

```{r warning=FALSE}
library(ggplot2)
library(tidyverse)
```


```{r}
dat = read.csv('data_ex1.csv')
dat
attach(dat)
```

### <u>a) Make a drawing of those observations</u>

```{r}
ggplot(data = dat,aes(x=percent_agricultural_population,y=calories_per_day_per_person)) + 
  geom_point(shape=18,color="blue",size=2)+
  geom_text(aes(label=country),hjust=0, vjust=0)
```

### <u>b) Estimate the parameters of the model: Yi = β0 + β1.xi + εi</u>

```{r}
LM = lm(calories_per_day_per_person~percent_agricultural_population)
LM$coefficients
```

- β0 = "(Intercept)" = 3346.12221
- β1 = "percent_agricultural_population" = -17.16353

### <u>c) Explain the different outputs of the lm funtions used in the R software and precise the tests that are performed and how they are performed.</u>

```{r}
summary(LM)
```

- Residuals:

  Difference between observed value and the one predicted by the model.
  We look for a symmetric distribution of the residuals around 0

- Coefficients:
  - Estimate: Estimation of β0 and β1 of our model.
  - Std. Error: is the standard deviation of the estimate
  - t value: Estimate / Std. error
  - Pr(>|t|): probability to observe value larger than t
    Student test performed for each parameter individually: H0 -> β1 = 0, H1 -> β1 != 0
    
    $$ P_{H0}\left ( \left | \widehat{\beta _{1}} \right |>t \right ) 
    with:
     \widehat{\beta _{1}} = \frac{\sum_{i=1}^{n}\left ( X_{i} - \bar{X_{n}} \right )(Y_{i} - \bar{Y_{n}})}{\sum_{i=1}^{n}\left ( X_{i} - \bar{X_{n}} \right )^{2}} $$

- Residual standard error:

- Multiple R-squared: 
  
  $$ R^{2} =\frac{\sum_{i=1}^{n}\left ( \widehat{Y_{i}}-\overline{Y_{n}} \right )^{2}}{\sum_{i=1}^{n}\left ( Y_{i}-\overline{Y_{n}} \right )^{2}} $$
  also called coefficient of determination = variance explained / total variance = 1 - (variance of residuals / variance total)
  
  gives information about goodness of fit of the model, should be close to one to be a correct linear model

- Adjusted R-squared:
  
  corrected version of R², taking unbiased estimator for the variances 

  $$ R_{adj}^{2}=1-\frac{n-1}{n-p-1}\left ( 1-R^{2} \right ) with: p\ nb\ of\ model\ in\ parameters $$

- F-statistic:

  - p-value:

  F-Statistics is a test to validate the model: 
  it's a global Fisher Test with H0: β1 = 0 , H1 β1 != 0

### <u>d) Construt a confidence interval at 95% for the regression curve, at a point x0</u>


## **cf cours 20091212 page 5/15**


```{r}
pred = predict(LM, dat,interval="confidence")
```


### <u>e) Draw the points, the regression curve and the curves associated to the confident interval on the same graphic.</u>

```{r}
dat2 = cbind(dat,pred)
ggplot(data=dat2 ) + 
  geom_point(aes(x=percent_agricultural_population, y=calories_per_day_per_person),shape=18,color="blue",size=2)+
  geom_text(aes(x=percent_agricultural_population, y=calories_per_day_per_person,label=country),hjust=0, vjust=0)+
  geom_line(aes(x=percent_agricultural_population, y=fit),col="red") + 
  geom_line(aes(x=percent_agricultural_population, y=lwr),linetype = "dashed",col="red") + 
  geom_line(aes(x=percent_agricultural_population, y=upr),linetype = "dashed",col="red")

```



