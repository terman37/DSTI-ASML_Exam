---
title: "ASML EXAM Exercise 3"
output: html_notebook
header-includes:
   - \usepackage{bbm}
---

```{r warning=FALSE}
library(ggplot2)
library(tidyverse)
```

```{r}
load(file = "test2.RData")
dat=data2
```

```{r}
head(dat)
```


### <u>(a) Perform the multiple regression model and analyse all the outputs that are available.</u>

```{r}
LM = lm(Y~.,data = dat)
```

```{r}
plot(LM,3)
```

```{r}
plot(LM,2)
```

```{r}
summary(LM)
```

- Adjusted R-squared is not close to 1: the linear model will not be able to explain all the variance
- noise is gaussian: following straight line on QQplot
- we can see also that noise is not homoscedastic: points are not spread equally on standardized residuals vs fitted values

### <u>(b) Is this model interesting?</u>

Model is not interresting, noise assumptions are not satisfied and Adjusted R-squared is not good.

### <u>(c) Perform a non-linear model and analyse it.</u>

```{r fig.width=15}
library(car)
```

```{r fig.height=15, fig.width=15, warning=FALSE}
scatterplotMatrix(dat)
```

```{r fig.height=15, fig.width=15, warning=FALSE}

dat2 = dat
dat2$X1 = dat2$X1
dat2$X2 = dat2$X2
dat2$X3 = sqrt(dat2$X3)
dat2$X4 = sqrt(dat2$X4)
dat2$X5 = dat2$X5^2
dat2$X6 = sqrt(dat2$X6)
dat2$X7 = dat2$X7
dat2$X8 = dat2$X8
dat2$X9 = dat2$X9

scatterplotMatrix(dat2[])
# for(i in 2:10){
#   hist(dat[,i],freq = FALSE )
#   plot(dat[,i],dat2$Y,title(main = i-1))
# }
```


```{r}
LM = lm(Y~.,data = dat2)

plot(LM,2)
plot(LM,3)
```

```{r}
summary(LM)
```




### <u>(d) What are the variables that are really connected to the response variable?</u>


